# The OpenAI API key
quarkus.langchain4j.openai.api-key=${OPENAI_API_KEY:test-openai-key}
quarkus.langchain4j.openai.base-url=${OPENAI_BASE_URL:https://api.openai.com}/v1

# Base URL / client configuration for the memory service that this agent delegates to
# memory-service.client.url=${MEMORY_SERVICE_URL:http://localhost:8081}
quarkus.quinoa=true
quarkus.quinoa.ui-dir=../../../common/chat-frontend
quarkus.quinoa.package-manager-install.node-version=20.10.0
quarkus.quinoa.package-manager-install=false
quarkus.quinoa.ui-root-path=/
quarkus.quinoa.build-dir=dist

# Keycloak dev services - expose on port 8081 and import realm
quarkus.keycloak.devservices.enabled=true
quarkus.keycloak.devservices.port=8081
quarkus.keycloak.devservices.realm-path=../../../common/keycloak/memory-service-realm.json

# OIDC / Keycloak configuration (bearer token validation for frontend OIDC)
quarkus.oidc.client-id=agent-frontend
quarkus.oidc.application-type=service
quarkus.oidc.roles.source=accesstoken

# Authentication: all API endpoints require bearer token
quarkus.http.auth.permission.api.paths=/v1/*
quarkus.http.auth.permission.api.policy=authenticated
quarkus.http.auth.permission.public.paths=/q/*
quarkus.http.auth.permission.public.policy=permit
quarkus.http.auth.permission.attachment-download.paths=/v1/attachments/download/*
quarkus.http.auth.permission.attachment-download.policy=permit
quarkus.http.auth.permission.static.paths=/*
quarkus.http.auth.permission.static.policy=permit

# Enable PostgreSQL dev service for the memory-service container to use
quarkus.datasource.db-kind=postgresql
quarkus.datasource.devservices.enabled=true
quarkus.datasource.devservices.db-name=memory_service
# To be able to use the pgvector dev service, we need to set the image name
quarkus.datasource.devservices.image-name=pgvector/pgvector:pg17

# Enable Redis-based cache (response resumer will automatically use it)
# Enable Redis dev service for the memory-service container to use
quarkus.redis.devservices.enabled=true
memory-service.cache.type=redis
memory-service.client.api-key=agent-api-key-1

# To allow admin access to the memory service
memory-service.devservices.port=8082
memory-service.devservices.env.MEMORY_SERVICE_API_KEYS_AGENT=agent-api-key-1
memory-service.devservices.env.MEMORY_SERVICE_ROLES_ADMIN_OIDC_ROLE=admin
memory-service.devservices.env.MEMORY_SERVICE_ROLES_AUDITOR_OIDC_ROLE=auditor
memory-service.devservices.env.MEMORY_SERVICE_ROLES_INDEXER_CLIENTS=agent
memory-service.devservices.env.QUARKUS_HTTP_CORS=true
memory-service.devservices.env.QUARKUS_HTTP_CORS_ORIGINS=http://localhost:3000

# Enable HTTP access logging
#quarkus.http.access-log.enabled=true
#quarkus.log.category."io.quarkus.http.access-log".level=INFO

# Use the alt profile to run both the memory-service and chat-quarkus in dev mode.
#   ./mvnw -T 1C -pl :memory-service quarkus:dev
#   ./mvnw -T 1C -pl :chat-quarkus quarkus:dev -Dquarkus.profile=alt
%alt.quarkus.devservices.enabled=false
%alt.memory-service.client.url=http://localhost:8082
%alt.memory-service.client.api-key=agent-api-key-1
%alt.quarkus.oidc.auth-server-url=http://localhost:8081/realms/memory-service
%alt.quarkus.oidc.token-issuer=http://localhost:8081/realms/memory-service
%alt.quarkus.oidc.client-id=memory-service-client
%alt.quarkus.oidc.credentials.secret=change-me


quarkus.log.category."io.github.chirino.memory.langchain4j".level=DEBUG
quarkus.log.category."io.github.chirino.memory.client.RestClientRequestLoggingFilter".level=WARN