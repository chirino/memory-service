@import "tailwindcss";

/* Typography plugin for prose styling */
@plugin "@tailwindcss/typography";

/* Custom theme configuration */
@theme {
  /* Custom colors for the memory service brand */
  --color-primary-50: oklch(0.97 0.02 260);
  --color-primary-100: oklch(0.93 0.04 260);
  --color-primary-200: oklch(0.86 0.08 260);
  --color-primary-300: oklch(0.76 0.12 260);
  --color-primary-400: oklch(0.65 0.16 260);
  --color-primary-500: oklch(0.55 0.20 260);
  --color-primary-600: oklch(0.48 0.22 260);
  --color-primary-700: oklch(0.40 0.20 260);
  --color-primary-800: oklch(0.33 0.16 260);
  --color-primary-900: oklch(0.27 0.12 260);
  --color-primary-950: oklch(0.18 0.08 260);

  /* Accent colors */
  --color-accent-400: oklch(0.75 0.18 180);
  --color-accent-500: oklch(0.65 0.20 180);
  --color-accent-600: oklch(0.55 0.18 180);

  /* Dark mode surface colors */
  --color-surface-50: oklch(0.98 0 0);
  --color-surface-100: oklch(0.96 0 0);
  --color-surface-200: oklch(0.92 0 0);
  --color-surface-800: oklch(0.22 0.01 260);
  --color-surface-900: oklch(0.16 0.01 260);
  --color-surface-950: oklch(0.12 0.01 260);

  /* Custom spacing for docs layout */
  --width-sidebar: 280px;
  --width-content: 800px;
}

/* Base layer customizations */
@layer base {
  html {
    scroll-behavior: smooth;
  }

  body {
    @apply bg-white text-gray-900 antialiased;
    @apply dark:bg-surface-950 dark:text-gray-100;
  }

  /* Ensure code blocks have proper styling */
  pre {
    @apply rounded-lg border border-gray-200 dark:border-gray-700 relative;
  }

  /* Mermaid diagram containers — hidden until rendered to prevent flash of raw text */
  pre.mermaid {
    @apply bg-white dark:bg-gray-900 p-4 text-center;
    visibility: hidden;
    min-height: 100px;
  }

  pre.mermaid[data-processed="true"] {
    visibility: visible;
  }

  /* Copy button for code blocks */
  .code-copy-btn {
    @apply absolute top-2 right-2 p-1.5 rounded-md opacity-0 transition-opacity;
    @apply bg-gray-700 hover:bg-gray-600 text-gray-300 hover:text-white;
    @apply focus:outline-none focus:ring-2 focus:ring-primary-500;
  }

  pre:hover .code-copy-btn {
    @apply opacity-100;
  }

  .code-copy-btn.copied {
    @apply opacity-100 bg-green-600 hover:bg-green-600 text-white;
  }

  /* View source button for CodeFromFile blocks */
  .code-source-btn {
    @apply absolute top-2 right-10 p-1.5 rounded-md opacity-0 transition-opacity;
    @apply bg-gray-700 hover:bg-gray-600;
    @apply focus:outline-none focus:ring-2 focus:ring-primary-500;
    color: #d1d5db !important;
    text-decoration: none !important;
  }

  .code-source-btn:hover {
    color: #fff !important;
  }

  pre:hover .code-source-btn {
    @apply opacity-100;
  }

  code {
    @apply text-sm;
  }

  /* Inline code styling */
  :not(pre) > code {
    @apply bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded text-primary-600 dark:text-primary-400;
  }
}

/* Component layer for reusable patterns */
@layer components {
  /* Button base styles - expanded inline to avoid @apply circular reference in v4 */
  .btn {
    @apply inline-flex items-center justify-center px-4 py-2 rounded-lg font-medium transition-colors;
    @apply focus:outline-none focus:ring-2 focus:ring-offset-2;
  }

  .btn-primary {
    @apply inline-flex items-center justify-center px-4 py-2 rounded-lg font-medium transition-colors;
    @apply focus:outline-none focus:ring-2 focus:ring-offset-2;
    @apply bg-primary-600 text-white hover:bg-primary-700;
    @apply focus:ring-primary-500;
  }

  .btn-secondary {
    @apply inline-flex items-center justify-center px-4 py-2 rounded-lg font-medium transition-colors;
    @apply focus:outline-none focus:ring-2 focus:ring-offset-2;
    @apply bg-gray-100 text-gray-900 hover:bg-gray-200;
    @apply dark:bg-gray-800 dark:text-gray-100 dark:hover:bg-gray-700;
    @apply focus:ring-gray-500;
  }

  .btn-outline {
    @apply inline-flex items-center justify-center px-4 py-2 rounded-lg font-medium transition-colors;
    @apply focus:outline-none focus:ring-2 focus:ring-offset-2;
    @apply border-2 border-primary-600 text-primary-600 hover:bg-primary-50;
    @apply dark:border-primary-400 dark:text-primary-400 dark:hover:bg-primary-950;
    @apply focus:ring-primary-500;
  }

  .card {
    @apply bg-white dark:bg-surface-900 rounded-xl border border-gray-200 dark:border-gray-800;
    @apply shadow-sm hover:shadow-md transition-shadow;
  }

  .nav-link {
    @apply text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-100;
    @apply transition-colors;
  }

  .nav-link-active {
    @apply text-primary-600 dark:text-primary-400 font-medium;
  }

  /* Sidebar navigation styles */
  .sidebar-section {
    @apply mb-6;
  }

  .sidebar-section-collapsed {
    @apply mb-1;
  }

  .sidebar-section:has(+ .sidebar-section-collapsible) {
    @apply mb-1;
  }

  .sidebar-heading {
    @apply text-xs font-semibold uppercase tracking-wider text-gray-500 dark:text-gray-400 px-3;
  }

  a.sidebar-heading {
    @apply block no-underline hover:text-gray-900 dark:hover:text-gray-100 transition-colors border-l-2 border-transparent py-1.5 rounded-md;
  }

  a.sidebar-heading-collapsible {
    @apply flex items-center gap-1;
  }

  a.sidebar-heading h3 {
    @apply text-xs font-semibold uppercase tracking-wider mb-0;
    color: inherit;
  }

  a.sidebar-heading-active {
    @apply bg-primary-50 dark:bg-primary-950 text-primary-700 dark:text-primary-300;
    @apply border-primary-600 dark:border-primary-400;
  }

  .sidebar-chevron {
    @apply w-3.5 h-3.5 flex-shrink-0 transition-transform duration-200;
  }

  .sidebar-chevron-expanded {
    @apply rotate-90;
  }

  .sidebar-items-indented {
    @apply ml-2 pl-2 border-l border-gray-200 dark:border-gray-700;
  }

  .sidebar-link {
    @apply block px-3 py-1.5 text-sm text-gray-600 dark:text-gray-400 rounded-md;
    @apply hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-gray-100;
    @apply transition-colors border-l-2 border-transparent;
  }

  .sidebar-link-nested {
    @apply pl-6; /* Additional left padding for 3rd level items */
  }

  .sidebar-link-active {
    @apply bg-primary-50 dark:bg-primary-950 text-primary-700 dark:text-primary-300;
    @apply border-l-2 border-primary-600 dark:border-primary-400;
  }

  /* Config format toggle bar */
  .config-toggle {
    @apply sticky z-30 flex items-center gap-3 py-2 px-3 mb-6 rounded-lg;
    @apply bg-gray-50/95 dark:bg-surface-900/95 backdrop-blur;
    @apply border border-gray-200 dark:border-gray-700;
    top: 4.5rem;
  }

  .config-toggle-label {
    @apply text-sm font-medium text-gray-500 dark:text-gray-400;
  }

  .config-toggle-buttons {
    @apply inline-flex rounded-md overflow-hidden border border-gray-300 dark:border-gray-600;
  }

  .config-toggle-btn {
    @apply px-3 py-1 text-xs font-medium transition-colors cursor-pointer;
    @apply bg-white dark:bg-surface-800 text-gray-600 dark:text-gray-400;
    @apply hover:bg-gray-100 dark:hover:bg-gray-700;
  }

  .config-toggle-btn + .config-toggle-btn {
    @apply border-l border-gray-300 dark:border-gray-600;
  }

  html[data-config-format="property"] .config-toggle-btn[data-format="property"],
  html[data-config-format="env"] .config-toggle-btn[data-format="env"] {
    @apply bg-primary-600 text-white;
  }

  html[data-config-format="property"] .config-toggle-btn[data-format="property"]:hover,
  html[data-config-format="env"] .config-toggle-btn[data-format="env"]:hover {
    @apply bg-primary-700;
  }

  /* Config format switching — inline keys */
  code.cfg-prop { display: none; }

  html[data-config-format="property"] code.cfg-prop { display: inline; }
  html[data-config-format="property"] code.cfg-env { display: none; }

  /* Config format switching — code blocks */
  .config-block .cfg-prop { display: none; }

  html[data-config-format="property"] .config-block .cfg-prop { display: block; }
  html[data-config-format="property"] .config-block .cfg-env { display: none; }
}

/* Utility layer for custom utilities */
@layer utilities {
  .text-balance {
    text-wrap: balance;
  }

  .gradient-text {
    @apply bg-gradient-to-r from-primary-600 to-accent-500 bg-clip-text text-transparent;
  }

  .gradient-bg {
    @apply bg-gradient-to-br from-primary-500 to-accent-500;
  }
}
